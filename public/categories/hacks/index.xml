<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Hacks on </title>
    <link>http://qnot.org/categories/hacks/</link>
    <description>Recent content in Hacks on </description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Fri, 01 Jul 2011 04:15:21 +0000</lastBuildDate>
    <atom:link href="http://qnot.org/categories/hacks/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>passtab - store passwords in your wallet</title>
      <link>http://qnot.org/2011/07/01/passtab---store-passwords-in-your-wallet/</link>
      <pubDate>Fri, 01 Jul 2011 04:15:21 +0000</pubDate>
      
      <guid>http://qnot.org/2011/07/01/passtab---store-passwords-in-your-wallet/</guid>
      <description>&lt;p&gt;Here&amp;rsquo;s a quote from &lt;a href=&#34;http://www.schneier.com/blog/archives/2005/06/write_down_your.html&#34;&gt;Bruce
Schneier&lt;/a&gt;
that essentially sums up the motivation for this post:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;We&amp;rsquo;re all good at securing small pieces of paper. I recommend that people write
their passwords down on a small piece of paper, and keep it with their other
valuable small pieces of paper: in their wallet.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;I recently read an excellent &lt;a href=&#34;http://blog.jgc.org/2010/12/write-your-passwords-down.html&#34;&gt;blog
post&lt;/a&gt; by John
Graham-Cumming in which he presents a elegant system for writing down your
passwords using a &lt;a href=&#34;http://en.wikipedia.org/wiki/Tabula_recta&#34;&gt;Tabula Recta&lt;/a&gt;. I
was inspired by this concept so I created a tool called
&lt;a href=&#34;https://github.com/aebruno/passtab&#34;&gt;passtab&lt;/a&gt; which aims to provide a
light-weight system for managing passwords based on his idea. This post is
about the general usage of passtab and presents some of the password management
capabilities. This is not your grandmothers password manager so if you&amp;rsquo;re
looking for a nice GUI point and click application that&amp;rsquo;s easy to use you can
stop reading right here. This is for hardcore folks who enjoy looking up their
passwords in archaic
&lt;a href=&#34;https://secure.wikimedia.org/wikipedia/en/wiki/Tabula_recta&#34;&gt;tablets&lt;/a&gt; invented
by ancient cryptographers with last names like
&lt;a href=&#34;https://secure.wikimedia.org/wikipedia/en/wiki/Johannes_Trithemius&#34;&gt;Trithemius&lt;/a&gt;.
For the impatient, you can grab a copy of the latest version on
&lt;a href=&#34;https://github.com/aebruno/passtab/archives/master&#34;&gt;github&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Introducing passtab&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://github.com/aebruno/passtab&#34;&gt;passtab&lt;/a&gt; is a light-weight system for
managing passwords using a Tabula Recta. passtab has two main features: 1.
generating random Tabula Recta&amp;rsquo;s in PDF format for printing and storing in your
wallet 2. fetching passwords from the Tabula Recta (password managment). These
features are independent and you can use passtab to only generate PDFs or
optionally make use of the password management features. One unique benefit is
the ability to have both an electronic and paper copy of your passwords. You
can download the binary release of passtab at github
&lt;a href=&#34;https://github.com/aebruno/passtab/archives/master&#34;&gt;here&lt;/a&gt;. Unpack the
distribution and run &lt;code&gt;./bin/passtab --help&lt;/code&gt; for a list of options. If the
startup shell script doesn&amp;rsquo;t work you can run &lt;code&gt;java -jar lib/passtab-uber.jar
--help&lt;/code&gt;. The following sections illustrate some use cases of passtab.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Generate a random Tabula Recta in PDF&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;passtab can generate random Tabula Recta&amp;rsquo;s in PDF format.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ ./bin/passtab --format pdf --output passtab.pdf
Jun 12, 2011 11:16:29 AM org.qnot.passtab.PassTab generate
INFO: Generating a random Tabula Recta (might take a while)...
$ ls *.pdf
passtab.pdf
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Here&amp;rsquo;s an &lt;a href=&#34;http://qnot.org/media/passtab.pdf&#34;&gt;example PDF&lt;/a&gt; generated from passtab. You can now
print this PDF out and store in your wallet!&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;How to use the Tabula Recta&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Here&amp;rsquo;s a simple example (taken directly from the
&lt;a href=&#34;https://github.com/aebruno/passtab/blob/master/README&#34;&gt;README&lt;/a&gt;), suppose we
have the following Tabula Recta:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;     | A B C D E F G H I J K L M N 
   --|----------------------------
   A | _ u } I ` } R ) a &amp;lt; L : a A 
   B | - o ( : p # O % . _ ; &#39; j L 
   C | w c ( c y 2 h y ~ N O * &amp;gt; w 
   D | o : R m L % V , d H r Y B j 
   E | 9 , &amp;lt; 0 J p a o ) O w 0 w # 
   F | C j i } i z 2 $ O R 5 @ T I 
   G | Q - E m 8 N c / + u W Y V &amp;gt; 
   H | , y } U Y i j i q w q c - 4 
   I | K j W H e ; I ? E 7 H v 2 + 
   J | g * 7 4 E } a h Y z &amp;lt; &amp;quot; : w 
   K | . _ } I / J k 1 a D ^ ; p K 
   L | ` &amp;lt; A L c z } } I P ? 4 y T 
   M | F D &amp;lt; 8 &amp;lt; 0 R B t 9 X o B 2 
   N | I r O E m o a + Y W w ; : 7
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And suppose we want to get our password for logging into webmail at acme.com.
We decide to use the first and last letter of the domain name as the start
row/column of the password and we want a password 8 characters in length. So we
start at the intersection of &amp;lsquo;A&amp;rsquo; and &amp;lsquo;E&amp;rsquo; and read off 8 characters diagonally
resulting in the password: &lt;code&gt;&#39;#h,)RWc&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Defining a scheme for selecting the starting row/column for a given password is
completely up to the user and can be as simple or as complex as one desires.
The direction for reading the password is also up to the user to define (left,
right, diagonally, etc.). See John Graham-Cumming&amp;rsquo;s excellent &lt;a href=&#34;http://blog.jgc.org/2010/12/write-your-passwords-down.html&#34;&gt;blog
post&lt;/a&gt; for more
examples.&lt;/p&gt;

&lt;p&gt;This method is slightly more complex than just writing down your passwords on a
sheet of paper but the added complexity offers some advantages:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Can store &lt;em&gt;all&lt;/em&gt; your passwords on a single sheet of paper&lt;/li&gt;
&lt;li&gt;If someone steals this sheet of paper they&amp;rsquo;ll have a harder time figuring
out what your passwords are&lt;/li&gt;
&lt;li&gt;Allows you to use strong random passwords&lt;/li&gt;
&lt;li&gt;If you want to change your passwords just re-generate a new Tabula Recta.
Your scheme for selecting passwords can stay the same&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;passtab makes no assumptions about how passwords are read nor does it know
anything about your scheme (unless you configure it). Now that you don&amp;rsquo;t have
to remember long random passwords anymore what &lt;em&gt;do&lt;/em&gt; you need to remember when
using a Tabula Recta? Well first, you need to come up with a method for finding
the starting position for a given password. In the example above this can be as
simple as using characters from a domain/host name. But the beauty is you can
be as creative as you want. A scheme that works for most of your passwords
would probably be ideal but you can certainly generate multiple Tabula Recta&amp;rsquo;s
if you like. Once you have a way of coming up with a starting location you need
to define a method for reading off the password. In passtab this is called a
&lt;code&gt;sequence&lt;/code&gt;. In the example above we simply read 8 characters diagonally. But
again you can be creative here. You could read 8 characters diagonally skipping
every 3rd character, etc. Lastly, you&amp;rsquo;ll need to remember what to do if you hit
the edge of the Tabula Recta before the end of the password. For example, if
you start at Z:Z and want to read 8 characters diagonally you can&amp;rsquo;t because you
reached the end of the Tabula Recta. In passtab this is called a &lt;code&gt;collision&lt;/code&gt;.
In this case we could just continue reading following the edge.&lt;/p&gt;

&lt;p&gt;Using the Tabula Recta allows you to make use of long secure random passwords
and only have to remember three simple things. You also have &lt;em&gt;all&lt;/em&gt; your
passwords on a single sheet of paper that fits in your wallet.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Custom Alphabets&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;In passtab, a Tabula Recta consists of two alphabets. The header alphabet and
the data alphabet. The header alphabet is used for the row and column heading
of the Tabula Recta and forms the basis for finding the starting location of
the passwords. The data alphabet is used to generate the contents of the Tabula
Recta and passtab will randomly pick characters from this alphabet using a
cryptographically secure random number generator. By default, passtab uses a
header alphabet of &lt;code&gt;0-9A-Z&lt;/code&gt; and a data alphabet consisting of all printable
ASCII characters. It&amp;rsquo;s important to keep in mind that the data alphabet
directly effects the
&lt;a href=&#34;https://secure.wikimedia.org/wikipedia/en/wiki/Password_strength#Entropy_as_a_measure_of_password_strength&#34;&gt;entropy&lt;/a&gt;
of your passwords. passtab allows you to customize these alphabets allowing you
to generate any kind of Tabula Recta, for example:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ ./bin/passtab -b A,B,C,D -a &#39;a,b,c,d,1,2,3,4,!,@,#&#39;
Jun 12, 2011 10:24:26 PM org.qnot.passtab.PassTab generate
INFO: Generating a random Tabula Recta (might take a while)...
  A B C D 
A d 1 @ 4 
B c 4 @ 2 
C b 3 3 ! 
D 1 a @ 4 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Here&amp;rsquo;s a Tabula Recta using greek symbols as the header alphabet (here&amp;rsquo;s the
&lt;a href=&#34;http://qnot.org/media/passtab-greek.pdf&#34;&gt;example PDF&lt;/a&gt;):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ ./bin/passtab -b &#39;Σ,Τ,Π,ρ,ϋ,ψ&#39; -a &#39;a,b,c,d,1,2,3,4,!,@,#&#39;
Jun 12, 2011 11:26:00 PM org.qnot.passtab.PassTab generate
INFO: Generating a random Tabula Recta (might take a while)...
  Σ Τ Π ρ ϋ ψ 
Σ 1 2 1 d d c 
Τ 1 2 b b @ c 
Π 1 # c 3 2 @ 
ρ 4 2 d 2 @ 3 
ϋ 2 3 b 1 ! b 
ψ d @ # c ! a
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Password Management&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;So this is all well and great, but in reality it can be a huge pain to have to
look up your webmail password in a Tabula Recta that&amp;rsquo;s on a sheet of paper in
your wallet &lt;em&gt;every time you login&lt;/em&gt;. For this reason, passtab has some optional
features to help read passwords from the Tabula Recta. This allows you to have
both a hard copy of the Tabula Recta in your wallet and an electronic version
stored on your hard drive for quick access to your passwords. This obviously
comes with some security considerations and care must be taken to protect the
passtab database as you would any ssh private key for example. If someone got a
hold of the passtab database file they could brute force your Tabula Recta. I
ended up creating an encrypted thumb drive and store my passtab configuration
and database files on it. You could also use gpg to encrypt it or any other
method to protect it from the bad guys. This next section discusses the
password management features of passtab.&lt;/p&gt;

&lt;p&gt;First some definitions:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Direction&lt;/strong&gt;: a &lt;code&gt;direction&lt;/code&gt; to move on the Tabula Recta. Valid values are
&lt;code&gt;N,S,E,W,NE,NW,SE,SW&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Sequence Item&lt;/strong&gt;: a &lt;code&gt;sequence item&lt;/code&gt; consists of a &lt;code&gt;length&lt;/code&gt; and &lt;code&gt;direction&lt;/code&gt;.
For example, &lt;code&gt;12:SE&lt;/code&gt; would mean move 12 characters in the SE direction
(diagonally)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Sequence&lt;/strong&gt;: a &lt;code&gt;sequence&lt;/code&gt; is a list of &lt;code&gt;sequence items&lt;/code&gt;. This allows you to
define arbitrary sequences for reading passwords. For example, &lt;code&gt;4:SE,3:N,1:S&lt;/code&gt;
would mean read 4 characters SE (diagonally) followed by 3 characters N (up)
followed by 1 character S (down)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Collision&lt;/strong&gt;: a &lt;code&gt;collision&lt;/code&gt; defines what directions to move if we hit the
edge of the Tabula Recta before the end of the password. You can define more
than one direction and they will be tried in order. For example,
N,NE,E,SE,S,SW,W,NW would mean if we hit a wall try those directions in order
until we&amp;rsquo;re able to move again&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;Generate a Tabula Recta in PDF and save to a passtab database&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;passtab can generate a Tabula Recta in PDF along with storing it in a passtab
database. The passtab database is stored in &lt;a href=&#34;http://json.org/&#34;&gt;JSON&lt;/a&gt; format and
can be easily accessed outside of passtab (any language that can read JSON
files). Again, you&amp;rsquo;ll want to store that JSON file someplace safe. For example:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ ./bin/passtab --dbsave --name mypasstab
Jun 12, 2011 10:48:33 PM org.qnot.passtab.PassTab generate
INFO: Generating a random Tabula Recta (might take a while)...
$ ls mypasstab.*
mypasstab.json  mypasstab.pdf
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Reading passwords from the passtab database&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Once we&amp;rsquo;ve created our passtab database we can now fetch passwords by telling
passtab the starting location and the sequence to read. For example, suppose we
want to read a password starting at row &amp;lsquo;B&amp;rsquo; and column &amp;lsquo;N&amp;rsquo; and we want a
password 10 characters in length reading diagonally:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ ./bin/passtab -i mypasstab.json --getpass B:N --sequence 9:SE
o6,ZzH{e$@
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Copy the password to the clipboard using xclip:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ ./bin/passtab -i mypasstab.json --getpass B:N --sequence 9:SE --chomp | xclip
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;We used &lt;code&gt;9:SE&lt;/code&gt; as our sequence because passtab includes the character at the
start location in the password. If we didn&amp;rsquo;t want to include this character we
can optionally skip it like so:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ ./bin/passtab -i mypasstab.json --getpass B:N --sequence 10:SE --skipstart
6,ZzH{e$@_
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Define a list of directions to try in the event of a collision. This will try
the directions N,S,E,W in order until we can move again. Here we start at Z:Z
and can&amp;rsquo;t move SE (diagonally) so we try N (up) which works so we move N (up)
until we hit another collision:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ ./bin/passtab -i mypasstab.json --getpass Z:Z --sequence 9:SE --collision N,S,E,W
a((vy&amp;amp;0bV&amp;amp;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Conclusion&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;This post introduced a new tool called passtab for managing passwords using a
Tabula Recta. I&amp;rsquo;m sure it has plenty of bugs so use at your own risk and if by
chance you find it somewhat useful I&amp;rsquo;d be very interested in any feedback.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>WordPress Blog to Print Book - A Case Study</title>
      <link>http://qnot.org/2011/04/09/wordpress-blog-to-print-book---a-case-study/</link>
      <pubDate>Sat, 09 Apr 2011 05:05:18 +0000</pubDate>
      
      <guid>http://qnot.org/2011/04/09/wordpress-blog-to-print-book---a-case-study/</guid>
      <description>&lt;p&gt;In this post I discuss my experience converting a WordPress blog into a print
book. This is by no means a generic how-to guide but more along the lines of a
case study. There&amp;rsquo;s a number of ways one could tackle this problem however I
wasn&amp;rsquo;t able to find any existing methods that fit my needs. Specifically, I
wanted to convert the content of a WordPress blog into a high quality print
ready PDF book (complete with chapters, sections, table of contents, images,
figures, page numbering, index, etc.) which could then be sent to various
&lt;a href=&#34;http://en.wikipedia.org/wiki/Print_on_demand&#34;&gt;POD&lt;/a&gt; publishers such as
&lt;a href=&#34;http://www.lulu.com/&#34;&gt;Lulu&lt;/a&gt; for printing. I wanted to streamline as much of
the process as possible to allow for regenerating the PDF book as new posts are
made. Ideally there would be a WordPress plugin for this but to make such a
plugin generic enough would be tricky and require many assumptions to be made
regarding the structure of your blog (i.e. what constitutes a chapter or a
section?, etc.). In this post I describe how I ended up creating a PDF book
from WordPress and discuss a few challenges I encountered along the way. A
brief disclaimer: this post is intended for folks who are familiar with *nix
command line and enjoy mucking around in code (and don&amp;rsquo;t mind slinging around
some XML here and there). It&amp;rsquo;s not for the faint of heart but hopefully it will
be useful to others interested in a similar outcome.&lt;/p&gt;

&lt;p&gt;If you&amp;rsquo;d rather skip this epic post and dive right into the code you can browse
it all over on &lt;a href=&#34;https://github.com/aebruno/wp2print&#34;&gt;github&lt;/a&gt;. There&amp;rsquo;s a
&lt;a href=&#34;https://github.com/aebruno/wp2print/blob/master/README&#34;&gt;README&lt;/a&gt; file and a
&lt;a href=&#34;https://github.com/aebruno/wp2print/blob/master/Makefile&#34;&gt;Makefile&lt;/a&gt; which
details how to run wp2print and includes a simple example.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Background and Assumptions&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;The idea for this project came about as my family has been writing a private
blog that I want to be able to share with my children some day. I&amp;rsquo;ve often
thought about giving them a copy of the blog when their much older and wondered
what would be the best way to preserve the content ensuring it&amp;rsquo;s viewable years
down the road. I thought by creating a physical copy of the blog I could have
something tangible to pass down through the generations. Using the services
provided by companies like Lulu and Blurb printing a book is as simple as
uploading a PDF and designing a cover. Having &lt;a href=&#34;http://oreilly.com/&#34;&gt;worked&lt;/a&gt; in
the publishing industry in a former life I had some experience generating PDF
books so I looked forward to the challenge.&lt;/p&gt;

&lt;p&gt;As my goal was to create a book I needed to convert the content of the blog
into an intermediate format which represented the book and could then be used
to generate a PDF file. As I had a good amount of experience slinging around
&lt;a href=&#34;http://www.docbook.org/&#34;&gt;DocBook&lt;/a&gt;, my general idea was to export the content
from WordPress and convert it into DocBook. Then converting DocBook into a PDF
is fairly straightforward using the wonderful &lt;a href=&#34;http://docbook.sourceforge.net/&#34;&gt;DocBook
stylesheets&lt;/a&gt; and &lt;a href=&#34;http://xmlgraphics.apache.org/fop/&#34;&gt;Apache
FOP&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The first obvious challenge when converting a blog into a book is deciding how
to go about organizing the blog posts into chapters and sections. Our family
blog was authored in such a way that each post had only one tag (category) and
most importantly all posts were tagged chronologically. Meaning that all posts
in a given category were sequential. For example, posts 0-5 are all tagged with
&amp;ldquo;tag1&amp;rdquo;, posts 6-10 are all tagged with &amp;ldquo;tag2&amp;rdquo;, and so on. You can probably see
where this is going. Having authored the blog in this format allowed me to
easily use each tag as a Chapter and each post appeared as a section within
that chapter. If your unable to make these assumptions about your blog (and
most likely you won&amp;rsquo;t be able to) just keep this in mind as we delve into the
code later on. You would need to modify the script I wrote and add in the
appropriate logic to slice your blog posts up into chapters/sections or however
you&amp;rsquo;d like to structure your DocBook file. I experimented with just making each
post a chapter (and even a series of DocBook
&lt;a href=&#34;http://www.docbook.org/tdg5/en/html/article.html&#34;&gt;articles&lt;/a&gt;) which isn&amp;rsquo;t a bad
option however depending on the number of posts you may want to consider
omitting the table of contents.&lt;/p&gt;

&lt;p&gt;A few other assumptions I made:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;All posts were written by the same author so I omitted displaying any author
information. Easy enough to add in if needed&lt;/li&gt;
&lt;li&gt;All comments were excluded from the book. Comments are an important part of
any blog but in this case my blog didn&amp;rsquo;t have very many comments. I was most
interested in the content of the post only and decided to omit any and all
comments. These could certainly be added in but some thought would be needed
on which DocBook element to use for structuring them within the book.&lt;/li&gt;
&lt;li&gt;There was one page (not a post) with the title &amp;ldquo;About&amp;rdquo; that I used as the
preface for the book. This can be any post/page or omitted completely if
desired.&lt;/li&gt;
&lt;li&gt;Access to the WordPress code that runs the blog. This won&amp;rsquo;t work if your blog
is hosted for example at WordPress.com. You&amp;rsquo;ll need to export your blog and
run it on your own server.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Here&amp;rsquo;s a brief outline of the entire process. I&amp;rsquo;ll go over each step in detail
in the next section.&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Convert WordPress content to DocBook using PHP and some XSLT&lt;/li&gt;
&lt;li&gt;Convert DocBook to &lt;a href=&#34;https://secure.wikimedia.org/wikipedia/en/wiki/XSL_Formatting_Objects&#34;&gt;XSL-FO&lt;/a&gt;
using DocBook stylesheets&lt;/li&gt;
&lt;li&gt;Convert XSL-FO to PDF using Apache FOP&lt;/li&gt;
&lt;li&gt;Upload PDF file to Lulu and order print book&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;strong&gt;Convert WordPress content to DocBook&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;First step was to convert the blog into DocBook. This was by far the most
challenging step. My first attempt was to use the
&lt;a href=&#34;https://en.support.wordpress.com/export/&#34;&gt;Export&lt;/a&gt; feature in WordPress which
dumps the entire contents of your blog in XML format (WordPress eXtended RSS)
and write an XSLT to convert into DocBook. This turned out to be slightly
harder than I anticipated because of how the content of each post was formatted
in the WordPress XML dump. It appeared to be in the native format WordPress
uses to store the post in the database and I didn&amp;rsquo;t want to have to write a
custom WordPress post renderer for DocBook. I decided to instead write a fairly
simple PHP script which used the WordPress API to render each post in HTML just
like it normally would if someone visited the site, then convert the HTML to
DocBook. I found converting the HTML to DocBook was slightly easier than having
to parse the native WordPress format. I did this in two steps, first I wrote a
PHP script to generate a quasi-DocBook file which uses the WordPress API to
embed the HTML content of each post within a &lt;code&gt;&amp;lt;section/&amp;gt;&lt;/code&gt;. Then I wrote an XSLT
which transforms the quasi-DocBook and embedded HTML into a final valid DocBook
file. The main PHP code is
&lt;a href=&#34;https://github.com/aebruno/wp2print/blob/master/lib/export-docbook.php&#34;&gt;here&lt;/a&gt;.
You&amp;rsquo;ll need to change the include paths in
&lt;a href=&#34;https://github.com/aebruno/wp2print/blob/master/lib/config.php&#34;&gt;config.php&lt;/a&gt; to
point to your WordPress installation (see the
&lt;a href=&#34;https://github.com/aebruno/wp2print/blob/master/Makefile&#34;&gt;Makefile&lt;/a&gt; for a
complete example).  The XSLT is
&lt;a href=&#34;https://github.com/aebruno/wp2print/blob/master/wp-html2docbook.xsl&#34;&gt;here&lt;/a&gt;. It
looks for various HTML tags that appear in my blog and converts those to valid
DocBook elements. I built up the XSLT by trial and error. I first just rendered
the quasi-DocBook generated from the PHP script as PDF. The DocBook stylesheets
have a nice feature in that any invalid DocBook elements it encounters are
highlighted in red in the resulting PDF. By iterating through the invalid
elements I was able to add the correct templates to my XSLT to account for all
HTML tags found in my blog posts. You&amp;rsquo;ll most certainly need to modify this
XSLT file to suite your specific needs but should serve as a decent starting
point. Here&amp;rsquo;s an example of the HTML generated by WordPress for an image
included in a blog post:&lt;/p&gt;

&lt;p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;span class=&#34;nt&#34;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;id=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;attachment_155&amp;quot;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;wp-caption aligncenter&amp;quot;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;width: 310px&amp;quot;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;nt&#34;&gt;&amp;lt;a&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;href=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;/wp-content/media/2008/11/image.jpg&amp;quot;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;lt;img&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;size-medium wp-image-155&amp;quot;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;title=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;image title&amp;quot;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;src=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;/wp-content/media/2008/11/image-300x218.jpg&amp;quot;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;alt=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;image alt&amp;quot;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;width=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;300&amp;quot;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;height=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;218&amp;quot;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;nt&#34;&gt;&amp;lt;/a&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;nt&#34;&gt;&amp;lt;p&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;wp-caption-text&amp;quot;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;This is a description of the image&lt;span class=&#34;nt&#34;&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/p&gt;

&lt;p&gt;Which then gets converted to a DocBook &lt;a href=&#34;http://www.docbook.org/tdg5/en/html/mediaobject.html&#34;&gt;mediaobject&lt;/a&gt; element:&lt;/p&gt;

&lt;p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;span class=&#34;nt&#34;&gt;&amp;lt;para&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;nt&#34;&gt;&amp;lt;mediaobject&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;nt&#34;&gt;&amp;lt;imageobject&amp;gt;&lt;/span&gt;
       &lt;span class=&#34;nt&#34;&gt;&amp;lt;imagedata&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;align=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;center&amp;quot;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;fileref=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;images/2008/11/image.jpg&amp;quot;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;width=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;4.0in&amp;quot;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;depth=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;3.0in&amp;quot;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;scalefit=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;1&amp;quot;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;format=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;JPG&amp;quot;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;nt&#34;&gt;&amp;lt;/imageobject&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;nt&#34;&gt;&amp;lt;caption&amp;gt;&amp;lt;para&amp;gt;&lt;/span&gt;This is a description of the image&lt;span class=&#34;nt&#34;&gt;&amp;lt;/para&amp;gt;&amp;lt;/caption&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;nt&#34;&gt;&amp;lt;/mediaobject&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;/para&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;A note about images&amp;hellip;&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Care must be taken to ensure any images you want included in the book are print
ready. I ended up having quite a few images in my blog that I wanted to include
in the final PDF which required some extra work to get them ready for printing.
For best results you&amp;rsquo;ll want make to be sure the resolution of your images are
at least 300ppi (&lt;a href=&#34;https://secure.wikimedia.org/wikipedia/en/wiki/Dots_per_inch#DPI_or_PPI_in_digital_image_files&#34;&gt;pixels per
inch&lt;/a&gt;).
See &lt;a href=&#34;http://connect.lulu.com/t5/Interior-Formatting/What-resolution-DPI-should-my-images-have-to-achieve-optimum/ta-p/31434&#34;&gt;this post on
Lulu&lt;/a&gt;.
For example, if your image is 600x600px and you set the resolution to be
300ppi, the printed image will be roughly 2x2in. In my case I was printing a
6x9 book and after factoring in margins/spine/bleed etc. I calculated the
maximum print size I wanted each image was 4x3in (as defined in the DocBook XML
element &lt;code&gt;&amp;lt;imagedata width=&amp;quot;4.0in&amp;quot; height=&amp;quot;3.0in&amp;quot;/&amp;gt;&lt;/code&gt; in the above example). As
most of the images were pictures, this print size ended up being large enough
so the photo was still viewable but small enough to allow for 2 images per
page. This meant that the minimum size (in pixels) each image had to be was
1200x900px. The problem was when we uploaded pictures to our blog we had
WordPress resize them to 500x400px (from their original size of 2816x2112px
from the camera). Fortunately, I still had the original image files which I
collected and used in the final PDF. Something to keep in mind if you have
images (especially photographs) in your blog that you want printed. I ran into
another edge case with the images which required a little bit of
&lt;a href=&#34;http://www.imagemagick.org&#34;&gt;imagemagick&lt;/a&gt;. I had a few important pictures that
were taken with photo booth on a mac in which the original size image was a
mere 640x480px. I knew the print version of the images would look dreadful so
my only option was to resample them to a higher resolution. This can easily be
accomplished using imagemagick&amp;rsquo;s &lt;a href=&#34;http://www.imagemagick.org/script/command-line-options.php#resample&#34;&gt;convert
command&lt;/a&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ convert -resample 300x orig.jpg hires.jpg
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In summary, be sure your images are high enough resolution for printing. It&amp;rsquo;s
definitely worth the extra work. I had roughly 100 images in my blog and all of
them turned out really nice in the final print book. I was quite impressed with
the quality of Lulu&amp;rsquo;s printers.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;DocBook &amp;ndash;&amp;gt; XSL-FO &amp;ndash;&amp;gt; PDF&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Converting DocBook to PDF was fairly straightforward using two excellent
projects &lt;a href=&#34;http://docbook.sourceforge.net/&#34;&gt;DocBook stylesheets&lt;/a&gt; and &lt;a href=&#34;http://xmlgraphics.apache.org/fop/&#34;&gt;Apache
FOP&lt;/a&gt;. I won&amp;rsquo;t cover how to install them on
your platform and refer you to the excellent INSTALL guides at the
&lt;a href=&#34;http://docbook.sourceforge.net/release/xsl/current/INSTALL&#34;&gt;respective&lt;/a&gt;
&lt;a href=&#34;http://xmlgraphics.apache.org/fop/quickstartguide.html&#34;&gt;sites&lt;/a&gt;. If you happen
to be running Ubuntu using the stock packages should work fine. Simply run
&lt;code&gt;aptitude install fop docbook-xsl&lt;/code&gt; and you should be all set. The basic goal
for this step was to use the DocBook XSL FO stylesheets to convert the DocBook
created from the previous step into XSL-FO which can be fed into Apache FOP for
conversion into PDF. This step required that an XSLT processor be installed
such as xsltproc (libXML), Saxon, Xalan, etc. I used xsltproc and can easily be
installed on Ubuntu &lt;code&gt;aptitude install xsltproc&lt;/code&gt;. After running xsltproc I
passed the resulting XSL-FO output into Apache FOP to generate the final PDF.
For more details see the
&lt;a href=&#34;https://github.com/aebruno/wp2print/blob/master/Makefile&#34;&gt;Makefile&lt;/a&gt;. Here&amp;rsquo;s
the basic commands:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ xsltproc /path/to/docbook-xsl/fo/docbook.xsl docbook-final.xml &amp;gt; book.fo
$ fop book.fo book.pdf
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The DocBook XSL FO stylesheets provide a &lt;a href=&#34;http://docbook.sourceforge.net/release/xsl/current/doc/fo/index.html&#34;&gt;generous number of
parameters&lt;/a&gt;
for customizing the resulting FO. The default parameter settings produce a very
nice looking PDF but if you like to tweak things there&amp;rsquo;s no shortage of knobs
to turn. As I ended up printing my book with Lulu there were a few specific
customizations that were required. First I was interested in printing a US
Trade 6x9 inch hard cover book so the default page
&lt;a href=&#34;http://docbook.sourceforge.net/release/xsl/current/doc/fo/page.width.html&#34;&gt;width&lt;/a&gt;/&lt;a href=&#34;http://docbook.sourceforge.net/release/xsl/current/doc/fo/page.height.html&#34;&gt;height&lt;/a&gt;
needed to be set accordingly. Some other tweaks I made included adjusting the
&lt;a href=&#34;http://docbook.sourceforge.net/release/xsl/current/doc/fo/page.margin.inner.html&#34;&gt;margins&lt;/a&gt;
slightly to provide some extra room on the &lt;a href=&#34;http://connect.lulu.com/t5/Interior-Formatting/How-big-should-my-margins-be/ta-p/31404&#34;&gt;spine
edge&lt;/a&gt;
of the book, customizing the &lt;a href=&#34;http://docbook.sourceforge.net/release/xsl/current/doc/fo/generate.toc.html&#34;&gt;table of
contents&lt;/a&gt;
to only include the chapter/sections, and &lt;a href=&#34;http://docbook.sourceforge.net/release/xsl/current/doc/fo/body.start.indent.html&#34;&gt;customizing the
indentation&lt;/a&gt;
of chapters and sections (in this case I didn&amp;rsquo;t want any indentation). Here&amp;rsquo;s
the resulting xsltproc command with the custom parameter settings:&lt;/p&gt;

&lt;p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;span class=&#34;nv&#34;&gt;$ &lt;/span&gt;xsltproc &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    --stringparam page.width 6in &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    --stringparam page.height 9in &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    --stringparam page.margin.inner 1.0in &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    --stringparam page.margin.outer 0.8in &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    --stringparam body.start.indent 0pt &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    --stringparam body.font.family  Times &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    --stringparam title.font.family Times &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    --stringparam dingbat.font.family Times &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    --stringparam generate.toc &lt;span class=&#34;s1&#34;&gt;&amp;#39;book toc title&amp;#39;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    --stringparam hyphenate &lt;span class=&#34;nb&#34;&gt;false&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    /path/to/docbook-xsl/fo/docbook.xsl &lt;span class=&#34;se&#34;&gt;\&lt;/span&gt;
    docbook-final.xml &amp;gt; book.fo
&lt;/pre&gt;&lt;/div&gt;
&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;A note about Fonts..&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;The last and most important configuration I made was with fonts. Lulu requires
fonts to be fully
&lt;a href=&#34;https://secure.wikimedia.org/wikipedia/en/wiki/Portable_Document_Format#Fonts&#34;&gt;embedded&lt;/a&gt;
which means any font you use in your PDF &lt;a href=&#34;http://www.lulu.com/help/embed_fonts&#34;&gt;must be
embedded&lt;/a&gt; (the font files are included
directly in the PDF file) or else they will reject the PDF. Embedding fonts is
supported by Apache FOP but requires some custom configuration. First I had to
decide which font to use. Fonts can be really tricky and I didn&amp;rsquo;t want to get
too fancy. Using a single font for the entire book was fine with me and I
decided to stick with a traditional Times New Roman font. I ended up using the
FreeSerif TrueType font from &lt;a href=&#34;http://www.gnu.org/software/freefont/&#34;&gt;GNU
FreeFont&lt;/a&gt;. It was already installed on
my Ubuntu machine and very easy to embed with Apache FOP. By default these
fonts are installed in &lt;code&gt;/usr/share/fonts/truetype/freefont/&lt;/code&gt;.There&amp;rsquo;s lots of
other free fonts out there that you could use including the &lt;a href=&#34;https://fedorahosted.org/liberation-fonts/&#34;&gt;Liberation
Fonts&lt;/a&gt; and even the &lt;a href=&#34;http://packages.ubuntu.com/lucid/ttf-mscorefonts-installer&#34;&gt;Micro$oft True
Type Core Fonts&lt;/a&gt;
which can be installed on Ubuntu by running &lt;code&gt;aptitude install msttcorefonts&lt;/code&gt;.
To configure Apache FOP to use GNU Free Fonts and embed them into the final PDF
I created a file called &lt;code&gt;userconf.xconf&lt;/code&gt; with the following lines:&lt;/p&gt;

&lt;p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot;?&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;fop&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;version=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;1.0&amp;quot;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;renderers&amp;gt;&lt;/span&gt;
   &lt;span class=&#34;nt&#34;&gt;&amp;lt;renderer&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;mime=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;application/pdf&amp;quot;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;c&#34;&gt;&amp;lt;!-- Full path to truetype fonts to be embedded in PDF file --&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;nt&#34;&gt;&amp;lt;fonts&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;lt;font&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;embed-url=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;file:///usr/share/fonts/truetype/freefont/FreeSerif.ttf&amp;quot;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;nt&#34;&gt;&amp;lt;font-triplet&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;name=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;Times&amp;quot;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;normal&amp;quot;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;weight=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;normal&amp;quot;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;lt;/font&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;lt;font&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;embed-url=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;file:///usr/share/fonts/truetype/freefont/FreeSerifBold.ttf&amp;quot;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;nt&#34;&gt;&amp;lt;font-triplet&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;name=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;Times&amp;quot;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;normal&amp;quot;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;weight=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;bold&amp;quot;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;lt;/font&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;lt;font&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;embed-url=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;file:///usr/share/fonts/truetype/freefont/FreeSerifItalic.ttf&amp;quot;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;nt&#34;&gt;&amp;lt;font-triplet&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;name=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;Times&amp;quot;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;italic&amp;quot;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;weight=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;normal&amp;quot;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;lt;/font&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;lt;font&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;embed-url=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;file:///usr/share/fonts/truetype/freefont/FreeSerifBoldItalic.ttf&amp;quot;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;nt&#34;&gt;&amp;lt;font-triplet&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;name=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;Times&amp;quot;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;italic&amp;quot;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;weight=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;bold&amp;quot;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;nt&#34;&gt;&amp;lt;/font&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;nt&#34;&gt;&amp;lt;/fonts&amp;gt;&lt;/span&gt;
   &lt;span class=&#34;nt&#34;&gt;&amp;lt;/renderer&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;/renderers&amp;gt;&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;/fop&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/p&gt;

&lt;p&gt;Then ran fop passing the -f option like so: &lt;code&gt;fop -f userconf.xconf book.fo
book.pdf&lt;/code&gt;. Note the &lt;code&gt;&amp;lt;font-triplet **name=&amp;quot;Times&amp;quot;** /&amp;gt;&lt;/code&gt; attribute must match
the &lt;code&gt;body.font.family Times&lt;/code&gt; XSLT parameter passed to xsltproc command.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Simple Example&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;All the code described in this post is available on
&lt;a href=&#34;https://github.com/aebruno/wp2print&#34;&gt;github&lt;/a&gt;. I also include a simple example
to demonstrate the entire conversion process and provide some sample PDFs to
see how final book renders. I created a simple test blog consisting of
Shakespeare&amp;rsquo;s Sonnets I thru X and exported the content in WordPress eXtended
RSS so you can then import into a fresh install of WordPress. I tested using
the latest version of WordPress at the time of this writing (v3.1). To try it
out yourself download the code for wp2print and read thru the
&lt;a href=&#34;https://github.com/aebruno/wp2print/blob/master/README&#34;&gt;README&lt;/a&gt; file which
outlines all the gory details. The
&lt;a href=&#34;https://github.com/aebruno/wp2print/blob/master/Makefile&#34;&gt;Makefile&lt;/a&gt; outlines
the general process and should provide a good starting point for experimenting.
Here&amp;rsquo;s some sample PDFs that were rendered from the example Shakespeare blog:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://qnot.org/media/book-with-chapters.pdf&#34;&gt;Book with Chapters and Sections&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://qnot.org/media/book-with-articles.pdf&#34;&gt;Book with all posts as DocBook Articles&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/aebruno/wp2print/blob/master/sample/sample-docbook.xml&#34;&gt;Raw DocBook output&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;Conclusion&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;With the help of a few simple scripts it&amp;rsquo;s possible to create a high quality
print ready PDF book from a WordPress blog. Depending on the content of the
blog you&amp;rsquo;ll most certainly need to tailor these scripts to suite your specific
requirements. The main challenges are figuring out how you want to organize
your blog posts into the framework of a book and then modifying the XSLT
templates to convert the WordPress html markup of your blog into valid DocBook
elements. The services offered by print on demand publishers such as Lulu
provide an easy way to turn the resulting PDF into a high quality paper book.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Database Design with Dia</title>
      <link>http://qnot.org/2007/12/06/database-design-with-dia/</link>
      <pubDate>Thu, 06 Dec 2007 05:23:48 +0000</pubDate>
      
      <guid>http://qnot.org/2007/12/06/database-design-with-dia/</guid>
      <description>&lt;p&gt;In this post I&amp;rsquo;m going to give a quick how-to on creating database schemas with
a wonderful tool called &lt;a href=&#34;http://live.gnome.org/Dia&#34;&gt;Dia&lt;/a&gt;. I&amp;rsquo;ve often found
having a nice visual representation of a database to be quite helpful but can&amp;rsquo;t
stand keeping it up to date. As soon as you add a new column or change the
design around you end up having to sync your visual diagram with your SQL
files. It&amp;rsquo;s tedious having to  manage the various SQL for building the database
and this can be a larger pain when trying to support different database
platforms each with their own SQL syntax. So before you create your next
database read on and see how Dia can make your life a bit easier.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://live.gnome.org/Dia&#34;&gt;Dia&lt;/a&gt; is a program for creating diagrams and for
this exercise we&amp;rsquo;ll be creating UML diagrams from within Dia. We&amp;rsquo;re also going
to use a perl script called &lt;a href=&#34;http://tedia2sql.tigris.org/&#34;&gt;tedia2sql&lt;/a&gt; which
will transform our Dia files directly to SQL for our target database. What&amp;rsquo;s
also nice about creating database schemas this way is that you can generate SQL
for multiple target databases without the maintenance overhead.&lt;/p&gt;

&lt;p&gt;First off, install a copy of Dia as well as tedia2sql. You can download
tedia2sql &lt;a href=&#34;http://tedia2sql.tigris.org/servlets/ProjectDocumentList&#34;&gt;here&lt;/a&gt; and
download Dia &lt;a href=&#34;http://live.gnome.org/Dia/Download&#34;&gt;here&lt;/a&gt;. I&amp;rsquo;m not going to cover
the install in this post but there should be packages available for most Linux
distro&amp;rsquo;s and if your not running Linux now is a great time to start!&lt;/p&gt;

&lt;p&gt;Fire up Dia, create a new diagram and save it as &amp;ldquo;employee.dia&amp;rdquo;. Select the UML
sheet from the drop down list. We&amp;rsquo;ll be using various UML objects to represent
tables and definitions that make up our database. Here&amp;rsquo;s a quick overview of
the main UML objects and their usage:&lt;/p&gt;

&lt;p&gt;
&lt;figure &gt;
    
        &lt;img src=&#34;http://qnot.org/media/dia_menu.jpg&#34; /&gt;
    
    
&lt;/figure&gt;
&lt;/p&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;UML object&lt;/th&gt;
&lt;th&gt;Description&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;img src=&#34;http://qnot.org/media/dia_class.png&#34; alt=&#34;&#34; /&gt;
&lt;/td&gt;
&lt;td&gt;Class represents a table in the database. A Class has a name which corresponds to the name of the table and attributes which map to the columns of the table. Attributes in classes can have visibility (public, private, protected). Protected attributes are primary keys. More on classes later.&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;img src=&#34;http://qnot.org/media/dia_component.png&#34; alt=&#34;&#34; /&gt;
&lt;/td&gt;
&lt;td&gt;Component is a special object that lets you define a list of default values to be inserted into a table. These are equivalent to hard coding &amp;ldquo;insert into ..&amp;rdquo; statements in your SQL files.&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;img src=&#34;http://qnot.org/media/dia_small_package.png&#34; alt=&#34;&#34; /&gt;
&lt;/td&gt;
&lt;td&gt;Small Package represents a typemap. Typemaps are used for adding custom SQL types such as MySQL tinyint.&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Now lets create our first table. Select the &amp;ldquo;Class&amp;rdquo; object icon from the UML
sheet and click inside the diagram editor window. This will add the class to
your diagram. Now right click on the new class and select &amp;ldquo;Show Properties&amp;rdquo;.
This will bring up a rather large and complex property window for the UML class
you&amp;rsquo;ve just created. We&amp;rsquo;re only going to customize a few properties outlined
below.&lt;/p&gt;

&lt;p&gt;First, under the &amp;ldquo;Class&amp;rdquo; tab enter the name of the table (employee) in the
&amp;ldquo;Class Name: &amp;ldquo; field. Next click on the &amp;ldquo;Attributes&amp;rdquo; tab and enter in the
columns of the table as attributes. In the &amp;ldquo;Name: &amp;ldquo; field enter in the column
name. In the &amp;ldquo;Type: &amp;ldquo; field enter in the SQL type for the column. If you want
to support multiple database platforms try to be generic here and only use ANSI
SQL 1992 or else use a typemap. More on typemaps later. In the &amp;ldquo;Value: &amp;ldquo; field
enter any default values for the column. For example, this is where you could
add in &amp;ldquo;not null&amp;rdquo;. If the column your adding is a primary key then don&amp;rsquo;t put
&amp;ldquo;not null&amp;rdquo; here and instead select &amp;ldquo;Protected&amp;rdquo; for the &amp;ldquo;Visibility: &amp;ldquo; field.
Not null will automatically get added to all primary keys on output generation.
The screen shot below is an example of the Class property editor window.&lt;/p&gt;

&lt;p&gt;
&lt;figure &gt;
    
        &lt;img src=&#34;http://qnot.org/media/dia_attributes.jpg&#34; /&gt;
    
    
&lt;/figure&gt;
&lt;/p&gt;

&lt;p&gt;Next, repeat the process for as many tables as you need in your database. For
this example, create two tables &amp;ldquo;employee&amp;rdquo; and &amp;ldquo;department&amp;rdquo; with the columns as
shown in the screenshot below (note the &amp;lsquo;#&amp;rsquo; in front of an attribute indicates
that it&amp;rsquo;s visibility is &amp;ldquo;Protected&amp;rdquo; thus making it a Primary Key):&lt;/p&gt;

&lt;p&gt;
&lt;figure &gt;
    
        &lt;img src=&#34;http://qnot.org/media/dia_employee.jpg&#34; /&gt;
    
    
&lt;/figure&gt;
&lt;/p&gt;

&lt;p&gt;This is a simple example of a database which stores employee data along with
the department they belong to. Now suppose we have a default list of
departments that we&amp;rsquo;d like to load into the department table when our database
is created. To do this we&amp;rsquo;ll use the &amp;ldquo;Component&amp;rdquo; object from the UML sheet.
Select the &amp;ldquo;Component&amp;rdquo; object and add it to your diagram editor window. Right
click and select &amp;ldquo;Properties&amp;rdquo;.&lt;/p&gt;

&lt;p&gt;
&lt;figure &gt;
    
        &lt;img src=&#34;http://qnot.org/media/dia_comp_prop.jpg&#34; /&gt;
    
    
&lt;/figure&gt;
&lt;/p&gt;

&lt;p&gt;In the &amp;ldquo;Stereotype: &amp;ldquo; field you basically enter in the first part of an &amp;ldquo;insert
into ..&amp;rdquo; SQL statement. For this example, to insert a default list of
departments we&amp;rsquo;d normally write the following SQL:&lt;/p&gt;

&lt;p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;span class=&#34;k&#34;&gt;insert&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;into&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;department&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;department_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;values&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Marketing&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;insert&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;into&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;department&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;department_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;values&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Production&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;insert&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;into&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;department&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;department_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;values&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Design&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/p&gt;

&lt;p&gt;So in this case, for the &amp;ldquo;Stereotype: &amp;ldquo; field we&amp;rsquo;d enter in &amp;ldquo;department
(department_id, name)&amp;ldquo;. Click OK to close the properties dialog. Now in the
Component object box enter in the values you&amp;rsquo;d like to insert, one per line.
Here&amp;rsquo;s what our diagram should look like now:&lt;/p&gt;

&lt;p&gt;
&lt;figure &gt;
    
        &lt;img src=&#34;http://qnot.org/media/dia_employee2.jpg&#34; /&gt;
    
    
&lt;/figure&gt;
&lt;/p&gt;

&lt;p&gt;Now lets add in a typemap. Typemaps are used for when you&amp;rsquo;d like to configure
custom types which are specific to a database platform. A good example of this
is MySQL auto_increment. This is a feature specific to MySQL and not supported
in all databases. Lets suppose we&amp;rsquo;d like to have a primary key column which
gets auto incremented upon each insert. But we also want to support both MySQL
and Apache Derby without having to maintain separate SQL files. To achieve this
we&amp;rsquo;ll create a custom typemap and define the specific SQL for each target db.&lt;/p&gt;

&lt;p&gt;Typemaps are created using a Small Package so select the &amp;ldquo;Small Package&amp;rdquo; object
and add it to your diagram editor window. Right click and select &amp;ldquo;Properties&amp;rdquo;.&lt;/p&gt;

&lt;p&gt;
&lt;figure &gt;
    
        &lt;img src=&#34;http://qnot.org/media/dia_type_prop.jpg&#34; /&gt;
    
    
&lt;/figure&gt;
&lt;/p&gt;

&lt;p&gt;In the &amp;ldquo;Stereotype: &amp;ldquo; field you enter in the target database. So for example
&amp;ldquo;mysql: typemap&amp;rdquo;.  For a list of supported target databases see tedia2sql
&amp;ndash;help. Some common ones are: postgres, mysql, sybase, oracle, db2, and innodb.
Click OK to close the properties dialog. Now inside the Small package box you
can enter custom types one per line. For this example we&amp;rsquo;ll create a custom
type with a name of &amp;ldquo;identity&amp;rdquo;. This means that when we generate our SQL files,
tedia2sql will replace the column type with our custom type. Here&amp;rsquo;s a few
examples:&lt;/p&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;MySQL typemaps&lt;/th&gt;
&lt;th&gt;Apache Derby typemaps&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;identity: int unsigned auto_increment&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;identity: int generated by default as identity&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;bigid: bigint unsigned auto_increment&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;bigid: long generated by default as identity&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Repeat the process for Apache Derby using &amp;ldquo;db2: typemap&amp;rdquo;.  Now that we&amp;rsquo;ve
defined our custom identity typemap we can change the employee_id column from
type &amp;ldquo;int&amp;rdquo; to type &amp;ldquo;identity&amp;rdquo;. We can also do the same for our department
table. Now these columns will be auto incrementing columns and depending on
which target database we select on output the correct SQL will be generated.
Our diagram should now look like this:&lt;/p&gt;

&lt;p&gt;
&lt;figure &gt;
    
        &lt;img src=&#34;http://qnot.org/media/dia_employee3.jpg&#34; /&gt;
    
    
&lt;/figure&gt;
&lt;/p&gt;

&lt;p&gt;At this point we have created our database schema and defined a default list of
departments to be inserted. We also created a typemap called &amp;ldquo;identity&amp;rdquo; which
defines auto incrementing columns for both MySQL and Apache derby. Now lets
generate the SQL files to create the database using tedia2sql. Before we run
tedia2sql we need to apply a small patch to the tedia2sql script. This fixes a
very small formatting issue in tedia2sql related to the typemaps we created.
Edit the tedia2sql script (/usr/bin/tedia2sql) and comment out the line inside
the parseTypeMap(..) subroutine that looks like this:&lt;/p&gt;

&lt;p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;span class=&#34;nv&#34;&gt;$defStr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=~&lt;/span&gt; &lt;span class=&#34;sr&#34;&gt;s/s//g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# ignore spaces&lt;/span&gt;
     &lt;span class=&#34;o&#34;&gt;--&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;change&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;to&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;--&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#   $defStr =~ s/s//g; # ignore spaces&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/p&gt;

&lt;p&gt;or just apply the patch I created
&lt;a href=&#34;http://qnot.org/data/tedia2sql-typemap-1.2.12.patch&#34;&gt;here&lt;/a&gt; (works for version 1.2.12):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ patch /usr/bin/tedia2sql &amp;amp;lt; tedia2sql-typemap-1.2.12.patch
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now we can generate the SQL files for our target databases:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ tedia2sql -i employee.dia -o employee-mysql.sql -t mysql -d
$ tedia2sql -i employee.dia -o employee-derby.sql -t db2 -d
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This will generate two SQL files for building the database in both MySQL and
Apache derby. If you view these files you can see how tedia2sql handled our
typemaps for the auto incrementing columns in each target database:&lt;/p&gt;

&lt;p&gt;MySQL
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;span class=&#34;c1&#34;&gt;-- employee&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;create&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;table&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;employee&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;employee_id&lt;/span&gt;                &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;auto_increment&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;department_id&lt;/span&gt;             &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;first_name&lt;/span&gt;                &lt;span class=&#34;nb&#34;&gt;varchar&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;255&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;last_name&lt;/span&gt;                 &lt;span class=&#34;nb&#34;&gt;varchar&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;255&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;start_date&lt;/span&gt;                &lt;span class=&#34;nb&#34;&gt;date&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;constraint&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pk_Employee&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;primary&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;key&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;employee_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/p&gt;

&lt;p&gt;Apache Derby
&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;span class=&#34;c1&#34;&gt;-- employee&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;create&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;table&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;employee&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;employee_id&lt;/span&gt;                &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;generated&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;by&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;default&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;identity&lt;/span&gt;  &lt;span class=&#34;k&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;department_id&lt;/span&gt;             &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;first_name&lt;/span&gt;                &lt;span class=&#34;nb&#34;&gt;varchar&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;255&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;last_name&lt;/span&gt;                 &lt;span class=&#34;nb&#34;&gt;varchar&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;255&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;start_date&lt;/span&gt;                &lt;span class=&#34;nb&#34;&gt;date&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;constraint&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pk_Employee&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;primary&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;key&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;employee_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/p&gt;

&lt;p&gt;You can download the files generated as well as the employee.dia file I used in
this tutorial here:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://qnot.org/data/employee.dia&#34;&gt;employee.dia&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://qnot.org/data/employee-mysql.sql&#34;&gt;employee-mysql.sql&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://qnot.org/data/employee-derby.sql&#34;&gt;employee-derby.sql&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;You can test the SQL files generated by tedia2sql and create the employee
database as follows:&lt;/p&gt;

&lt;p&gt;MySQL&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ mysql -u user -p dbname &amp;amp;lt; employee-mysql.sql
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Apache Derby&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ java -cp derby.jar:derbytools.jar \
       -Dderby.system.home=/path/to/dbroot \
       -Dij.protocol=jdbc:derby: \
       -Dij.database=&#39;employee;create=true&#39;
    org.apache.derby.tools.ij employee-derby.sql
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;A quick Makefile will help out a lot in testing out your database schema:&lt;/p&gt;

&lt;p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;span class=&#34;nf&#34;&gt;all&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;
      tedia2sql -i employee.dia -o employee-mysql.sql -t mysql -d
      tedia2sql -i employee.dia -o employee-derby.sql -t db2 -d
&lt;span class=&#34;nf&#34;&gt;clean&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;
      rm -f *.sql
&lt;/pre&gt;&lt;/div&gt;
&lt;/p&gt;

&lt;p&gt;I&amp;rsquo;ve found that for small to moderate size projects creating database schemas
in Dia and using tedia2sql for SQL generation to be a lifesaver. You can also
make use of Dia&amp;rsquo;s export feature to export your database schema to a number of
different formats such as jpg, png, eps, tiff, etc. I really only scratched the
surface of what can be done using these great tools. tedia2sql has support for
lots of cool features like indexes, foreign key constraints, views and much
more. For more information check out &lt;a href=&#34;http://tedia2sql.tigris.org/usingtedia2sql.html&#34;&gt;using
tedia2sql&lt;/a&gt;  and &lt;a href=&#34;http://dia-installer.de/doc/en/index.html&#34;&gt;Dia&amp;rsquo;s
manual&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Happy Diagramming!&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Customizing Pidgin Chat Windows</title>
      <link>http://qnot.org/2007/07/07/customizing-pidgin-chat-windows/</link>
      <pubDate>Sat, 07 Jul 2007 05:53:55 +0000</pubDate>
      
      <guid>http://qnot.org/2007/07/07/customizing-pidgin-chat-windows/</guid>
      <description>&lt;p&gt;In my &lt;a href=&#34;http://qnot.org/2007/01/14/customizing-gaim-chat-windows/&#34;&gt;previous post&lt;/a&gt; I discussed
customizing Gaim chat windows. Since then Gaim has formally changed it&amp;rsquo;s name
to &lt;a href=&#34;http://pidgin.im/pidgin/home/&#34;&gt;Pidgin&lt;/a&gt; due to &lt;a href=&#34;http://pidgin.im/~elb/cgi-bin/pyblosxom.cgi/going_public.html&#34;&gt;legal issues with
AOL&lt;/a&gt;. I finally
upgraded to Pidgin and had to do a few minor tweaks to get the same chat window
customizations as before.  I updated &lt;code&gt;~/.purple/gtkrc-2.0&lt;/code&gt; which previously
resided in &lt;code&gt;~/.gaim&lt;/code&gt; and changed the widget names from &lt;code&gt;gaim_gtkconv_*&lt;/code&gt; to
&lt;code&gt;pidgin_conv_*&lt;/code&gt;. Here&amp;rsquo;s my updated &lt;code&gt;~/.purple/gtkrc-2.0&lt;/code&gt; file:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;style &amp;quot;pidgin-dark&amp;quot; {
    base[NORMAL]=&amp;quot;#000000&amp;quot;
    text[NORMAL]=&amp;quot;#00FF00&amp;quot;
    GtkIMHtml::hyperlink-color=&amp;quot;#007FFF&amp;quot;
    GtkWidget::cursor-color=&amp;quot;#60AFFE&amp;quot;
    GtkWidget::secondary-cursor-color=&amp;quot;#A4D3EE&amp;quot;
}
widget &amp;quot;*pidgin_conv_imhtml&amp;quot; style &amp;quot;pidgin-dark&amp;quot;
widget &amp;quot;*pidgin_conv_entry&amp;quot; style &amp;quot;pidgin-dark&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>phpLDAPadmin and Kerberos</title>
      <link>http://qnot.org/2007/06/27/phpldapadmin-and-kerberos/</link>
      <pubDate>Wed, 27 Jun 2007 02:56:55 +0000</pubDate>
      
      <guid>http://qnot.org/2007/06/27/phpldapadmin-and-kerberos/</guid>
      <description>&lt;p&gt;I&amp;rsquo;ve been experimenting with
&lt;a href=&#34;http://phpldapadmin.sourceforge.net/&#34;&gt;phpLDAPadmin&lt;/a&gt; for browsing/searching
LDAP directories over the web and found it to be a wonderful tool. I&amp;rsquo;m
currently working with LDAP in a central authentication system together with
Kerberos and wanted to have a nice web interface for managing user information
within the LDAP directory. phpLDAPadmin provides a very nice interface for
browsing, searching, and updating entries which makes it a bit easier than
working with the ldap* command line tools. Here&amp;rsquo;s my basic setup of
phpLDAPadmin using Kerberos for authentication. This assumes you already have
an LDAP/Kerberos setup working and are using Apache as your web server.&lt;/p&gt;

&lt;p&gt;First step is to make sure you have
&lt;a href=&#34;http://en.wikipedia.org/wiki/Simple_Authentication_and_Security_Layer&#34;&gt;SASL&lt;/a&gt;
support compiled into the LDAP PHP extension &lt;code&gt;--with-ldap-sasl&lt;/code&gt;. Check out
phpinfo() and make sure you see &lt;code&gt;SASL Support   Enabled&lt;/code&gt; under the LDAP
extension. If not re-compile PHP.&lt;br /&gt;
Grab a copy of phpLDAPadmin
&lt;a href=&#34;http://phpldapadmin.sourceforge.net/download.php&#34;&gt;here&lt;/a&gt; and untar into a
directory of your choice (/usr/local). Copy the config.php.example to
config.php:&lt;/p&gt;

&lt;p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;span class=&#34;nv&#34;&gt;$ &lt;/span&gt;tar -xvxf phpldapadmin-x.x.x.tar.gz
&lt;span class=&#34;nv&#34;&gt;$ &lt;/span&gt;ln -s phpldapadmin-x.x.x phpldapadmin
&lt;span class=&#34;nv&#34;&gt;$ &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cd &lt;/span&gt;phpldapadmin
&lt;span class=&#34;nv&#34;&gt;$ &lt;/span&gt;cp config/config.php.example config/config.php
&lt;/pre&gt;&lt;/div&gt;
&lt;/p&gt;

&lt;p&gt;Edit config/config.php. A few options to define are as follows:&lt;/p&gt;

&lt;p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;span class=&#34;x&#34;&gt;$ldapservers-&amp;gt;SetValue($i,&amp;#39;server&amp;#39;,&amp;#39;name&amp;#39;,&amp;#39;My LDAP Server&amp;#39;);&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;$ldapservers-&amp;gt;SetValue($i,&amp;#39;server&amp;#39;,&amp;#39;host&amp;#39;,&amp;#39;ldap.host.com&amp;#39;);&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;$ldapservers-&amp;gt;SetValue($i,&amp;#39;server&amp;#39;,&amp;#39;port&amp;#39;,&amp;#39;389&amp;#39;);&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;$ldapservers-&amp;gt;SetValue($i,&amp;#39;server&amp;#39;,&amp;#39;auth_type&amp;#39;,&amp;#39;config&amp;#39;);&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;$ldapservers-&amp;gt;SetValue($i,&amp;#39;login&amp;#39;,&amp;#39;dn&amp;#39;,&amp;#39;&amp;#39;);&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;$ldapservers-&amp;gt;SetValue($i,&amp;#39;login&amp;#39;,&amp;#39;pass&amp;#39;,&amp;#39;&amp;#39;);&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;$ldapservers-&amp;gt;SetValue($i,&amp;#39;server&amp;#39;,&amp;#39;tls&amp;#39;,false);&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;$ldapservers-&amp;gt;SetValue($i,&amp;#39;server&amp;#39;,&amp;#39;sasl_auth&amp;#39;,true);&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;$ldapservers-&amp;gt;SetValue($i,&amp;#39;server&amp;#39;,&amp;#39;sasl_mech&amp;#39;,&amp;#39;GSSAPI&amp;#39;);&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;$ldapservers-&amp;gt;SetValue($i,&amp;#39;server&amp;#39;,&amp;#39;sasl_authz_id_regex&amp;#39;,&amp;#39;/^uid=([^,]+)(.+)/i&amp;#39;);&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;$ldapservers-&amp;gt;SetValue($i,&amp;#39;server&amp;#39;,&amp;#39;sasl_authz_id_replacement&amp;#39;,&amp;#39;$1&amp;#39;);&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;$ldapservers-&amp;gt;SetValue($i,&amp;#39;login&amp;#39;,&amp;#39;anon_bind&amp;#39;,false); &lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/p&gt;

&lt;p&gt;Basically, we&amp;rsquo;re configuring phpLDAPadmin with &lt;code&gt;auth_type = config&lt;/code&gt; which means
that the user/pass used to bind to the LDAP server is hard coded in the
config.php file. We leave the user/pass blank because each user will first be
authenticating through Kerberos and using their tickets to bind to the LDAP
server. Internally phpLDAPadmin calls the &lt;a href=&#34;http://us.php.net/manual/en/function.ldap-sasl-bind.php&#34;&gt;ldap_sasl_bind(..)&lt;/a&gt;
function with an &lt;code&gt;auth_mech&lt;/code&gt; of
&lt;a href=&#34;http://en.wikipedia.org/wiki/Generic_Security_Services_Application_Program_Interface&#34;&gt;GSSAPI&lt;/a&gt;
which does the work of binding using Kerberos tickets.&lt;/p&gt;

&lt;p&gt;Next, we&amp;rsquo;ll configure apache to point to the location where we installed
phpLDAPadmin. Edit your httpd.conf file or equivalent. If your running redhat
usually create a file in /etc/httpd/conf.d or on Debian
/etc/apache2/site-available/. You will probably want to add this to an SSL
vhost to ensure your username/passwords are transmitted over a secure
connection.&lt;/p&gt;

&lt;p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;span class=&#34;nb&#34;&gt;Alias&lt;/span&gt; &lt;span class=&#34;sx&#34;&gt;/ldapadmin&lt;/span&gt; &lt;span class=&#34;sx&#34;&gt;/usr/local/phpldapadmin/htdocs/&lt;/span&gt;
&lt;span class=&#34;nt&#34;&gt;&amp;lt;Location&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;/ldapadmin&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;AuthType&lt;/span&gt; Kerberos
    &lt;span class=&#34;nb&#34;&gt;AuthName&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;LDAP Admin&amp;quot;&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;KrbAuthRealms&lt;/span&gt; kerb.yourhost.com
    &lt;span class=&#34;nb&#34;&gt;KrbVerifyKDC&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;off&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;KrbServiceName&lt;/span&gt; HTTP
    &lt;span class=&#34;nb&#34;&gt;Krb5KeyTab&lt;/span&gt; &lt;span class=&#34;sx&#34;&gt;/path/to/your/httpd.keytab&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;KrbSaveCredentials&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;on&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;require&lt;/span&gt; valid-user
&lt;span class=&#34;nt&#34;&gt;&amp;lt;/Location&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/p&gt;

&lt;p&gt;In order to authenticate users against Kerberos and obtain the necessary
Kerberos tickets we use the apache module
&lt;a href=&#34;http://modauthkerb.sourceforge.net/&#34;&gt;mod_auth_kerb&lt;/a&gt;. The apache config above
defines our location for phpLDAPadmin and adds in the necessary config for
mod_auth_kerb. More info can be found
&lt;a href=&#34;http://modauthkerb.sourceforge.net/configure.html&#34;&gt;here&lt;/a&gt;. Make sure to add in
the &lt;code&gt;KrbSaveCredentails on&lt;/code&gt; directive so that mod_auth_kerb will save the
Kerberos tickets for use throughout the request.&lt;/p&gt;

&lt;p&gt;Next we need to expose the location of the Kerberos tickets to phpLDAPadmin.
mod_auth_kerb sets an environment variable &lt;code&gt;KRB5CCNAME&lt;/code&gt; to the location of the
credential cache. To expose this environment variable to the phpLDAPadmin code
edit the file &lt;code&gt;[phpLDAPadmin_install]/lib/common.php&lt;/code&gt; and add this line to the
very top:&lt;/p&gt;

&lt;p&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;span class=&#34;x&#34;&gt;putenv(&amp;quot;KRB5CCNAME={$_SERVER[&amp;#39;KRB5CCNAME&amp;#39;]}&amp;quot;); &lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/p&gt;

&lt;p&gt;That should do it. Now when you access &lt;a href=&#34;http://yourserver.com/ldapadmin&#34;&gt;http://yourserver.com/ldapadmin&lt;/a&gt; you
should be challenged with HTTP basic auth, which authenticates against Kerberos
and uses the Kerberos credentials to bind to your LDAP server. There might be
an easier way to go about doing this but I wasn&amp;rsquo;t able to turn much up on
google so I thought I&amp;rsquo;d share one way I was able to get things working.&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>